(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[526],{1017:function(e,n,r){"use strict";r.d(n,{Z:function(){return _}});var t=r(7294),o=r(4761),i=r(8427),a=r(2623);let l=(0,t.createContext)({padding:0}),s=l.Provider,useCardPadding=()=>(0,t.useContext)(l).padding;var c=r(6817),d=(0,c.k)((e,{padding:n,withBorder:r,inheritPadding:t})=>{let o=e.fn.size({size:n,sizes:e.spacing}),i=-1*o,a="dark"===e.colorScheme?e.colors.dark[4]:e.colors.gray[3];return{cardSection:{display:"block",marginLeft:i,marginRight:i,paddingLeft:t?o:void 0,paddingRight:t?o:void 0,borderTop:r&&`1px solid ${a}`,borderBottom:r&&`1px solid ${a}`,"& + &":{borderTop:0},"&[data-first]":{marginTop:i,borderTop:0,borderBottom:r&&`1px solid ${a}`},"&[data-last]":{marginBottom:i,borderBottom:0}}}}),m=r(4523),u=Object.defineProperty,p=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,n,r)=>n in e?u(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,__spreadValues=(e,n)=>{for(var r in n||(n={}))f.call(n,r)&&__defNormalProp(e,r,n[r]);if(p)for(var r of p(n))g.call(n,r)&&__defNormalProp(e,r,n[r]);return e},__objRest=(e,n)=>{var r={};for(var t in e)f.call(e,t)&&0>n.indexOf(t)&&(r[t]=e[t]);if(null!=e&&p)for(var t of p(e))0>n.indexOf(t)&&g.call(e,t)&&(r[t]=e[t]);return r};let h={withBorder:!1,inheritPadding:!1},x=(0,t.forwardRef)((e,n)=>{let r=(0,o.N4)("CardSection",h,e),{className:i,withBorder:a,inheritPadding:l,unstyled:s}=r,c=__objRest(r,["className","withBorder","inheritPadding","unstyled"]),{classes:u,cx:p}=d({padding:useCardPadding(),withBorder:a,inheritPadding:l},{name:"Card",unstyled:s});return t.createElement(m.x,__spreadValues({className:p(u.cardSection,i),ref:n},c))});x.displayName="@mantine/core/CardSection";let v=(0,i.F)(x);var y=(0,c.k)(e=>({root:{position:"relative",overflow:"hidden",backgroundColor:"dark"===e.colorScheme?e.colors.dark[6]:e.white}})),C=Object.defineProperty,w=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,Card_defNormalProp=(e,n,r)=>n in e?C(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,Card_spreadValues=(e,n)=>{for(var r in n||(n={}))b.call(n,r)&&Card_defNormalProp(e,r,n[r]);if(w)for(var r of w(n))j.call(n,r)&&Card_defNormalProp(e,r,n[r]);return e},Card_objRest=(e,n)=>{var r={};for(var t in e)b.call(e,t)&&0>n.indexOf(t)&&(r[t]=e[t]);if(null!=e&&w)for(var t of w(e))0>n.indexOf(t)&&j.call(e,t)&&(r[t]=e[t]);return r};let E={p:"md"},P=(0,t.forwardRef)((e,n)=>{let r=(0,o.N4)("Card",E,e),{className:i,p:l,radius:c,children:d,unstyled:m}=r,u=Card_objRest(r,["className","p","radius","children","unstyled"]),{classes:p,cx:f}=y(null,{name:"Card",unstyled:m}),g=t.Children.toArray(d),h=g.map((e,n)=>"object"==typeof e&&e&&"type"in e&&e.type===v?(0,t.cloneElement)(e,{padding:l,"data-first":0===n||void 0,"data-last":n===g.length-1||void 0}):e);return t.createElement(s,{value:{padding:l}},t.createElement(a.X,Card_spreadValues({className:f(p.root,i),radius:c,p:l,ref:n},u),h))});P.Section=v,P.displayName="@mantine/core/Card";let _=(0,i.F)(P)},6771:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/downloads",function(){return r(836)}])},730:function(e,n,r){"use strict";var t=r(5893),o=r(2623),i=r(1232),a=r(9236);r(7294),n.Z=function(e){let{title:n,icon:r,noBorder:l=!1}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(o.X,{p:"xl",pl:50,m:-25,mb:l?0:"md",withBorder:!l,sx:e=>({height:"100px",backgroundColor:e.colors.gray[0]}),children:(0,t.jsxs)(i.Z,{children:[r," ",(0,t.jsx)(a.D,{order:1,children:n})]})})})}},2046:function(e,n,r){"use strict";r.d(n,{Ex:function(){return consoleToText},IZ:function(){return getCommands},L6:function(){return getServerInfo},QL:function(){return submitCommand},S4:function(){return getNimplants},TW:function(){return getNimplantInfo},VG:function(){return timeSince},XP:function(){return serverExit},Xe:function(){return restoreConnectionError},ZS:function(){return getListenerString},a6:function(){return nimplantExit},cT:function(){return uploadFile},i$:function(){return formatTimestamp},or:function(){return showConnectionError},r5:function(){return getServerConsole},td:function(){return formatBytes},uV:function(){return getNimplantConsole},yb:function(){return getDownloads}});var t,o=r(3575),i=r(5592),a=r(9459),l=r(2043),s=r(9734),t=window.location.origin;let c={commands:"".concat(t,"/api/commands"),downloads:"".concat(t,"/api/downloads"),server:"".concat(t,"/api/server"),serverExit:"".concat(t,"/api/server/exit"),serverConsole:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(t,"/api/server/console/").concat(e,"/").concat(n)},upload:"".concat(t,"/api/upload"),nimplants:"".concat(t,"/api/nimplants"),nimplantInfo:e=>"".concat(t,"/api/nimplants/").concat(e),nimplantExit:e=>"".concat(t,"/api/nimplants/").concat(e,"/exit"),nimplantCommand:e=>"".concat(t,"/api/nimplants/").concat(e,"/command"),nimplantConsole:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(t,"/api/nimplants/").concat(e,"/console/").concat(n,"/").concat(r)},nimplantHistory:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return arguments.length>2&&void 0!==arguments[2]&&arguments[2],"".concat(t,"/api/nimplants/").concat(e,"/history/").concat(n)}},fetcher=e=>fetch(e).then(e=>e.json());function getCommands(){let{data:e,error:n}=(0,s.ZP)(c.commands,fetcher);return{commandList:e,commandListLoading:!n&&!e,commandListError:n}}function getDownloads(){let{data:e,error:n}=(0,s.ZP)(c.downloads,fetcher,{refreshInterval:5e3});return{downloads:e,downloadsLoading:!n&&!e,downloadsError:n}}function getServerInfo(){let{data:e,error:n}=(0,s.ZP)(c.server,fetcher);return{serverInfo:e,serverInfoLoading:!n&&!e,serverInfoError:n}}function getServerConsole(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3,{data:n,error:r}=(0,s.ZP)(c.serverConsole(e),fetcher,{refreshInterval:5e3});return{serverConsole:n,serverConsoleLoading:!r&&!n,serverConsoleError:r}}function getNimplants(){let{data:e,error:n}=(0,s.ZP)(c.nimplants,fetcher,{refreshInterval:2500});return{nimplants:e,nimplantsLoading:!n&&!e,nimplantsError:n}}function getNimplantInfo(e){let{data:n,error:r}=(0,s.ZP)(c.nimplantInfo(e),fetcher,{refreshInterval:5e3});return{nimplantInfo:n,nimplantInfoLoading:!r&&!n,nimplantInfoError:r}}function getNimplantConsole(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,{data:r,error:t}=(0,s.ZP)(c.nimplantConsole(e,n),fetcher,{refreshInterval:1e3});return{nimplantConsole:r,nimplantConsoleLoading:!t&&!r,nimplantConsoleError:t}}function serverExit(){fetch(c.serverExit,{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,o.c0)({title:"OK",message:"Server is shutting down",color:"green"})}).catch(()=>{(0,o.c0)({title:"Error",message:"Error shutting down server",color:"red"})})}function nimplantExit(e){fetch(c.nimplantExit(e),{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,o.c0)({title:"OK",message:"Killing Nimplant",color:"green"})}).catch(()=>{(0,o.c0)({title:"Error",message:"Error killing Nimplant",color:"red"})})}function submitCommand(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};fetch(c.nimplantCommand(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:n})}).then(e=>{e.ok?((0,o.c0)({title:"OK",message:"Command '"+n.split(" ")[0]+"' submitted",color:"green"}),r()):(0,o.c0)({title:"Error",message:"Error sending command",color:"red"})})}function uploadFile(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};if(e.size>5242880&&!confirm("The selected file is larger than 5MB, which may cause unpredictable behavior.\nAre you sure you want to continue?")){r();return}let t=new FormData;t.append("file",e),t.append("filename",e.name),fetch(c.upload,{method:"POST",body:t}).then(e=>{e.json().then(r=>{e.ok?((0,o.c0)({title:"OK",message:"File uploaded to server",color:"green"}),n(r.path)):(0,o.c0)({title:"Error",message:"Error uploading file",color:"red"})})})}function timeSince(e){let n=(0,l.Z)(e,"dd/MM/yyyy HH:mm:ss",new Date);return(0,a.Z)(n,{includeSeconds:!0,addSuffix:!0})}function formatBytes(e){if(0===e)return"0 B";let n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(1))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}function formatTimestamp(e){return(0,i.Z)(new Date(1e3*e),"yyyy/MM/dd HH:mm:ss")}function getListenerString(e){let n=e.config.listenerHost?e.config.listenerHost:e.config.listenerIp;var r=":".concat(e.config.listenerPort);return("HTTP"===e.config.listenerType&&80===e.config.listenerPort||"HTTPS"===e.config.listenerType&&443===e.config.listenerPort)&&(r=""),"".concat(e.config.listenerType.toLowerCase(),"://").concat(n).concat(r)}function consoleToText(e){for(var n="",r=0;r<e.length;r++)e[r].task&&(n+="[".concat(e[r].taskTime,"] > ").concat(e[r].taskFriendly,"\n")),n+="[".concat(e[r].resultTime,"]   ").concat(e[r].result,"\n");return n}function showConnectionError(){(0,o.c0)({id:"ConnErr",disallowClose:!0,autoClose:!1,title:"Connection error",message:"Trying to reconnect to Nimplant API server",color:"red",loading:!0})}function restoreConnectionError(){(0,o.wD)({id:"ConnErr",color:"teal",title:"Connection restored",message:"Connection to the Nimplant API server was restored",autoClose:3e3})}},836:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return downloads}});var t=r(5893),o=r(5154),i=r(3723),a=r(1232),l=r(5117),s=r(1017),c=r(4065),d=r(2046),m=r(7564),u=r(1664),p=r.n(u),components_DownloadList=function(){let{downloads:e,downloadsLoading:n,downloadsError:r}=(0,d.yb)(),{nimplants:i,nimplantsLoading:s,nimplantsError:c}=(0,d.S4)();return e&&0!==e.length?(0,t.jsx)(t.Fragment,{children:e.map((e,n)=>{var r,o;return(0,t.jsx)(a.Z,{py:"md",grow:!0,sx:e=>({"&:not(:last-child)":{borderBottom:"1px solid ".concat(e.colors.gray[1])},"&:hover":{cursor:"pointer"}}),children:(0,t.jsx)(p(),{href:"/api/downloads/".concat(e.nimplant,"/").concat(e.name),passHref:!0,style:{textDecoration:"none"},children:(0,t.jsxs)(a.Z,{grow:!0,children:[(0,t.jsx)(l.x,{size:"lg",color:"dark",children:e.name}),(0,t.jsxs)(m.K,{pl:5,spacing:0,children:[(0,t.jsx)(l.x,{size:"lg",color:"dark",children:e.nimplant}),(0,t.jsx)(l.x,{size:"md",color:"gray",children:i&&(null===(r=i.find(n=>n.guid===e.nimplant))||void 0===r?void 0:r.username)+"@"+(null===(o=i.find(n=>n.guid===e.nimplant))||void 0===o?void 0:o.hostname)})]}),(0,t.jsx)(l.x,{pl:10,size:"lg",color:"gray",children:(0,d.td)(e.size)}),(0,t.jsx)(l.x,{pl:20,size:"lg",color:"gray",children:(0,d.i$)(e.lastmodified)})]})})},n)})}):(0,t.jsxs)(a.Z,{py:"xl",sx:e=>({color:e.colors.gray[5]}),children:[(0,t.jsx)(o.UMU,{size:"1.5em"}),(0,t.jsx)(l.x,{size:"md",children:"Nothing here..."})]})},f=r(730),downloads=()=>{let e=(0,c.a)("(min-width: 800px)");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Z,{title:"Downloads",icon:(0,t.jsx)(o.aBF,{size:"2em"}),noBorder:!0}),(0,t.jsxs)(i.x,{ml:e?"sm":0,mr:e?"lg":"sm",mt:"xl",children:[(0,t.jsxs)(a.Z,{pl:e?25:10,mb:"lg",grow:!0,sx:e=>({color:e.colors.gray[5]}),children:[(0,t.jsx)(l.x,{size:"lg",children:"Filename"}),(0,t.jsx)(l.x,{size:"lg",children:"Nimplant"}),(0,t.jsx)(l.x,{size:"lg",children:"Size"}),(0,t.jsx)(l.x,{size:"lg",children:"Downloaded"})]}),(0,t.jsx)(s.Z,{withBorder:!0,radius:"md",my:"sm",py:0,px:e?"xl":"sm",children:(0,t.jsx)(components_DownloadList,{})})]})]})}}},function(e){e.O(0,[968,379,774,888,179],function(){return e(e.s=6771)}),_N_E=e.O()}]);