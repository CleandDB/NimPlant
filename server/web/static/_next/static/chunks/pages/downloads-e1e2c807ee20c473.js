(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[526],{6771:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/downloads",function(){return t(8030)}])},6867:function(n,e,t){"use strict";var o=t(5893),r=t(4124),i=t(356),a=t(8008);t(7294),e.Z=function(n){let{title:e,icon:t,noBorder:l=!1}=n;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(r.X,{p:"xl",pl:50,m:-25,mb:l?0:"md",withBorder:!l,style:{height:"100px",backgroundColor:"var(--mantine-color-gray-0)"},children:(0,o.jsxs)(i.Z,{children:[t," ",(0,o.jsx)(a.D,{order:1,children:e})]})})})}},8650:function(n,e,t){"use strict";t.d(e,{Ex:function(){return P},IZ:function(){return u},L6:function(){return p},QL:function(){return y},S4:function(){return f},TW:function(){return g},VG:function(){return j},XP:function(){return v},Xe:function(){return b},ZS:function(){return T},a6:function(){return w},cT:function(){return C},i$:function(){return N},or:function(){return Z},r5:function(){return h},td:function(){return E},uV:function(){return x},yb:function(){return m}});var o,r=t(4998),i=t(4157),a=t(3899),l=t(2164),s=t(1758),o=window.location.origin;let c={commands:"".concat(o,"/api/commands"),downloads:"".concat(o,"/api/downloads"),server:"".concat(o,"/api/server"),serverExit:"".concat(o,"/api/server/exit"),serverConsole:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(o,"/api/server/console/").concat(n,"/").concat(e)},upload:"".concat(o,"/api/upload"),nimplants:"".concat(o,"/api/nimplants"),nimplantInfo:n=>"".concat(o,"/api/nimplants/").concat(n),nimplantExit:n=>"".concat(o,"/api/nimplants/").concat(n,"/exit"),nimplantCommand:n=>"".concat(o,"/api/nimplants/").concat(n,"/command"),nimplantConsole:function(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(o,"/api/nimplants/").concat(n,"/console/").concat(e,"/").concat(t)},nimplantHistory:function(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return arguments.length>2&&void 0!==arguments[2]&&arguments[2],"".concat(o,"/api/nimplants/").concat(n,"/history/").concat(e)}},d=n=>fetch(n).then(n=>n.json());function u(){let{data:n,error:e}=(0,s.ZP)(c.commands,d);return{commandList:n,commandListLoading:!e&&!n,commandListError:e}}function m(){let{data:n,error:e}=(0,s.ZP)(c.downloads,d,{refreshInterval:5e3});return{downloads:n,downloadsLoading:!e&&!n,downloadsError:e}}function p(){let{data:n,error:e}=(0,s.ZP)(c.server,d);return{serverInfo:n,serverInfoLoading:!e&&!n,serverInfoError:e}}function h(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3,{data:e,error:t}=(0,s.ZP)(c.serverConsole(n),d,{refreshInterval:5e3});return{serverConsole:e,serverConsoleLoading:!t&&!e,serverConsoleError:t}}function f(){let{data:n,error:e}=(0,s.ZP)(c.nimplants,d,{refreshInterval:2500});return{nimplants:n,nimplantsLoading:!e&&!n,nimplantsError:e}}function g(n){let{data:e,error:t}=(0,s.ZP)(c.nimplantInfo(n),d,{refreshInterval:5e3});return{nimplantInfo:e,nimplantInfoLoading:!t&&!e,nimplantInfoError:t}}function x(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,{data:t,error:o}=(0,s.ZP)(c.nimplantConsole(n,e),d,{refreshInterval:1e3});return{nimplantConsole:t,nimplantConsoleLoading:!o&&!t,nimplantConsoleError:o}}function v(){fetch(c.serverExit,{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{r.N9.show({title:"OK",message:"Server is shutting down",color:"green"})}).catch(()=>{r.N9.show({title:"Error",message:"Error shutting down server",color:"red"})})}function w(n){fetch(c.nimplantExit(n),{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{r.N9.show({title:"OK",message:"Killing Nimplant",color:"green"})}).catch(()=>{r.N9.show({title:"Error",message:"Error killing Nimplant",color:"red"})})}function y(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};fetch(c.nimplantCommand(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e})}).then(n=>{n.ok?(r.N9.show({title:"OK",message:"Command '"+e.split(" ")[0]+"' submitted",color:"green"}),t()):r.N9.show({title:"Error",message:"Error sending command",color:"red"})})}function C(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};if(n.size>5242880&&!confirm("The selected file is larger than 5MB, which may cause unpredictable behavior.\nAre you sure you want to continue?")){t();return}let o=new FormData;o.append("file",n),o.append("filename",n.name),fetch(c.upload,{method:"POST",body:o}).then(n=>{n.json().then(t=>{n.ok?(r.N9.show({title:"OK",message:"File uploaded to server",color:"green"}),e(t.path)):r.N9.show({title:"Error",message:"Error uploading file",color:"red"})})})}function j(n){let e=(0,i.Qc)(n,"dd/MM/yyyy HH:mm:ss",new Date);return(0,a.Q)(e,{includeSeconds:!0,addSuffix:!0})}function E(n){if(0===n)return"0 B";let e=Math.floor(Math.log(n)/Math.log(1024));return parseFloat((n/Math.pow(1024,e)).toFixed(1))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][e]}function N(n){return(0,l.WU)(new Date(1e3*n),"yyyy/MM/dd HH:mm:ss")}function T(n){let e=n.config.listenerHost?n.config.listenerHost:n.config.listenerIp;var t=":".concat(n.config.listenerPort);return("HTTP"===n.config.listenerType&&80===n.config.listenerPort||"HTTPS"===n.config.listenerType&&443===n.config.listenerPort)&&(t=""),"".concat(n.config.listenerType.toLowerCase(),"://").concat(e).concat(t)}function P(n){for(var e="",t=0;t<n.length;t++)n[t].task&&(e+="[".concat(n[t].taskTime,"] > ").concat(n[t].taskFriendly,"\n")),e+="[".concat(n[t].resultTime,"]   ").concat(n[t].result,"\n");return e}function Z(){r.N9.show({id:"ConnErr",autoClose:!1,color:"red",withCloseButton:!1,loading:!0,message:"Trying to reconnect to Nimplant API server",title:"Connection error"})}function b(){r.N9.update({id:"ConnErr",autoClose:3e3,color:"teal",withCloseButton:!0,loading:!1,message:"Connection to the Nimplant API server was restored",title:"Connection restored"})}},8030:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return v}});var o=t(5893),r=t(4066),i=t(6721),a=t(356),l=t(4410),s=t(8878),c=t(8964),d=t(8650),u=t(8207),m=t(1664),p=t.n(m),h=t(5964),f=t.n(h),g=function(){let{downloads:n,downloadsLoading:e,downloadsError:t}=(0,d.yb)(),{nimplants:i,nimplantsLoading:s,nimplantsError:c}=(0,d.S4)();return n&&0!==n.length?(0,o.jsx)(o.Fragment,{children:n.map((n,e)=>{var t,r;return(0,o.jsx)(a.Z,{py:"md",grow:!0,className:f().group,children:(0,o.jsx)(p(),{href:"/api/downloads/".concat(n.nimplant,"/").concat(n.name),passHref:!0,style:{textDecoration:"none"},children:(0,o.jsxs)(a.Z,{grow:!0,children:[(0,o.jsx)(l.x,{size:"lg",c:"dark",children:n.name}),(0,o.jsxs)(u.K,{pl:5,gap:0,children:[(0,o.jsx)(l.x,{size:"lg",c:"dark",children:n.nimplant}),(0,o.jsx)(l.x,{size:"md",c:"gray",children:i&&(null===(t=i.find(e=>e.guid===n.nimplant))||void 0===t?void 0:t.username)+"@"+(null===(r=i.find(e=>e.guid===n.nimplant))||void 0===r?void 0:r.hostname)})]}),(0,o.jsx)(l.x,{pl:10,size:"lg",color:"gray",children:(0,d.td)(n.size)}),(0,o.jsx)(l.x,{pl:20,size:"lg",color:"gray",children:(0,d.i$)(n.lastmodified)})]})})},e)})}):(0,o.jsxs)(a.Z,{py:"xl",style:{color:"var(--mantine-color-gray-5)"},children:[(0,o.jsx)(r.UMU,{size:"1.5em"}),(0,o.jsx)(l.x,{size:"md",children:"Nothing here..."})]})},x=t(6867),v=()=>{let n=(0,c.a)("(min-width: 800px)");return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(x.Z,{title:"Downloads",icon:(0,o.jsx)(r.aBF,{size:"2em"}),noBorder:!0}),(0,o.jsxs)(i.x,{ml:n?"sm":0,mr:n?"lg":"sm",mt:"xl",children:[(0,o.jsxs)(a.Z,{pl:n?25:10,mb:"lg",grow:!0,style:{color:"var(--mantine-color-gray-5)"},children:[(0,o.jsx)(l.x,{size:"lg",children:"Filename"}),(0,o.jsx)(l.x,{size:"lg",children:"Nimplant"}),(0,o.jsx)(l.x,{size:"lg",children:"Size"}),(0,o.jsx)(l.x,{size:"lg",children:"Downloaded"})]}),(0,o.jsx)(s.Z,{withBorder:!0,radius:"md",my:"sm",py:0,px:n?"xl":"sm",children:(0,o.jsx)(g,{})})]})]})}},5964:function(n){n.exports={group:"liststyles_group__QuRpK"}},8878:function(n,e,t){"use strict";t.d(e,{Z:function(){return v}});var o=t(7294),r=t(9429),i=t(3637),a=t(987),l=t(9581),s=t(3362),c=t(4124);let[d,u]=(0,t(679).R)("Card component was not found in tree");var m=t(8855),p={root:"m-e615b15f",section:"m-599a2148"};let h={},f=(0,s.b)((n,e)=>{let{classNames:t,className:r,style:i,styles:l,vars:s,withBorder:c,inheritPadding:d,mod:p,...f}=(0,a.w)("CardSection",h,n),g=u();return o.createElement(m.x,{ref:e,mod:[{"with-border":c,"inherit-padding":d},p],...g.getStyles("section",{className:r,style:i,styles:l,classNames:t}),...f})});f.classes=p,f.displayName="@mantine/core/CardSection";let g={},x=(0,i.Z)((n,{padding:e})=>({root:{"--card-padding":(0,r.bG)(e)}})),v=(0,s.b)((n,e)=>{let t=(0,a.w)("Card",g,n),{classNames:r,className:i,style:s,styles:u,unstyled:m,vars:h,children:v,padding:w,...y}=t,C=(0,l.y)({name:"Card",props:t,classes:p,className:i,style:s,classNames:r,styles:u,unstyled:m,vars:h,varsResolver:x}),j=o.Children.toArray(v),E=j.map((n,e)=>"object"==typeof n&&n&&"type"in n&&n.type===f?(0,o.cloneElement)(n,{"data-first-section":0===e||void 0,"data-last-section":e===j.length-1||void 0}):n);return o.createElement(d,{value:{getStyles:C}},o.createElement(c.X,{ref:e,unstyled:m,...C("root"),...y},E))});v.classes=p,v.displayName="@mantine/core/Card",v.Section=f}},function(n){n.O(0,[188,166,888,774,179],function(){return n(n.s=6771)}),_N_E=n.O()}]);