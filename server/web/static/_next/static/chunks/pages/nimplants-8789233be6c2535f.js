(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[121],{5801:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/nimplants",function(){return t(2456)}])},1876:function(n,e,t){"use strict";var r=t(5893),o=t(4124),i=t(356),s=t(8008);t(7294),e.Z=function(n){let{title:e,icon:t,noBorder:l=!1}=n;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(o.X,{p:"xl",pl:50,m:-25,mb:l?0:"md",withBorder:!l,style:{height:"100px",backgroundColor:"var(--mantine-color-gray-0)"},children:(0,r.jsxs)(i.Z,{children:[t," ",(0,r.jsx)(s.D,{order:1,children:e})]})})})}},3772:function(n,e,t){"use strict";t.d(e,{Ex:function(){return T},IZ:function(){return u},L6:function(){return h},QL:function(){return y},S4:function(){return f},TW:function(){return g},VG:function(){return C},XP:function(){return j},Xe:function(){return b},ZS:function(){return N},a6:function(){return v},cT:function(){return w},i$:function(){return E},or:function(){return P},r5:function(){return p},td:function(){return Z},uV:function(){return x},yb:function(){return m}});var r,o=t(4998),i=t(8954),s=t(7886),l=t(1686),a=t(1758),r=window.location.origin;let c={commands:"".concat(r,"/api/commands"),downloads:"".concat(r,"/api/downloads"),server:"".concat(r,"/api/server"),serverExit:"".concat(r,"/api/server/exit"),serverConsole:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(r,"/api/server/console/").concat(n,"/").concat(e)},upload:"".concat(r,"/api/upload"),nimplants:"".concat(r,"/api/nimplants"),nimplantInfo:n=>"".concat(r,"/api/nimplants/").concat(n),nimplantExit:n=>"".concat(r,"/api/nimplants/").concat(n,"/exit"),nimplantCommand:n=>"".concat(r,"/api/nimplants/").concat(n,"/command"),nimplantConsole:function(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(r,"/api/nimplants/").concat(n,"/console/").concat(e,"/").concat(t)}},d=n=>fetch(n).then(n=>n.json());function u(){let{data:n,error:e}=(0,a.ZP)(c.commands,d);return{commandList:n,commandListLoading:!e&&!n,commandListError:e}}function m(){let{data:n,error:e}=(0,a.ZP)(c.downloads,d,{refreshInterval:5e3});return{downloads:n,downloadsLoading:!e&&!n,downloadsError:e}}function h(){let{data:n,error:e}=(0,a.ZP)(c.server,d);return{serverInfo:n,serverInfoLoading:!e&&!n,serverInfoError:e}}function p(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3,{data:e,error:t}=(0,a.ZP)(c.serverConsole(n),d,{refreshInterval:5e3});return{serverConsole:e,serverConsoleLoading:!t&&!e,serverConsoleError:t}}function f(){let{data:n,error:e}=(0,a.ZP)(c.nimplants,d,{refreshInterval:2500});return{nimplants:n,nimplantsLoading:!e&&!n,nimplantsError:e}}function g(n){let{data:e,error:t}=(0,a.ZP)(c.nimplantInfo(n),d,{refreshInterval:5e3});return{nimplantInfo:e,nimplantInfoLoading:!t&&!e,nimplantInfoError:t}}function x(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,{data:t,error:r}=(0,a.ZP)(c.nimplantConsole(n,e),d,{refreshInterval:1e3});return{nimplantConsole:t,nimplantConsoleLoading:!r&&!t,nimplantConsoleError:r}}function j(){fetch(c.serverExit,{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{o.N9.show({title:"OK",message:"Server is shutting down",color:"green"})}).catch(()=>{o.N9.show({title:"Error",message:"Error shutting down server",color:"red"})})}function v(n){fetch(c.nimplantExit(n),{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{o.N9.show({title:"OK",message:"Killing Nimplant",color:"green"})}).catch(()=>{o.N9.show({title:"Error",message:"Error killing Nimplant",color:"red"})})}function y(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};fetch(c.nimplantCommand(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e})}).then(n=>{n.ok?(o.N9.show({title:"OK",message:"Command '"+e.split(" ")[0]+"' submitted",color:"green"}),t()):o.N9.show({title:"Error",message:"Error sending command",color:"red"})})}function w(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};if(n.size>5242880&&!confirm("The selected file is larger than 5MB, which may cause unpredictable behavior.\nAre you sure you want to continue?")){t();return}let r=new FormData;r.append("file",n),r.append("filename",n.name),fetch(c.upload,{method:"POST",body:r}).then(n=>{n.json().then(t=>{n.ok?(o.N9.show({title:"OK",message:"File uploaded to server",color:"green"}),e(t.path)):o.N9.show({title:"Error",message:"Error uploading file",color:"red"})})})}function C(n){let e=(0,i.Qc)(n,"dd/MM/yyyy HH:mm:ss",new Date);return(0,s.Q)(e,{includeSeconds:!0,addSuffix:!0})}function Z(n){if(0===n)return"0 B";let e=Math.floor(Math.log(n)/Math.log(1024));return parseFloat((n/Math.pow(1024,e)).toFixed(1))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][e]}function E(n){return(0,l.WU)(new Date(1e3*n),"yyyy/MM/dd HH:mm:ss")}function N(n){let e=n.config.listenerHost?n.config.listenerHost:n.config.listenerIp;var t=":".concat(n.config.listenerPort);return("HTTP"===n.config.listenerType&&80===n.config.listenerPort||"HTTPS"===n.config.listenerType&&443===n.config.listenerPort)&&(t=""),"".concat(n.config.listenerType.toLowerCase(),"://").concat(e).concat(t)}function T(n){for(var e="",t=0;t<n.length;t++)n[t].task&&(e+="[".concat(n[t].taskTime,"] > ").concat(n[t].taskFriendly,"\n")),e+="[".concat(n[t].resultTime,"]   ").concat(n[t].result,"\n");return e}function P(){o.N9.show({id:"ConnErr",autoClose:!1,color:"red",withCloseButton:!1,loading:!0,message:"Trying to reconnect to Nimplant API server",title:"Connection error"})}function b(){o.N9.update({id:"ConnErr",autoClose:3e3,color:"teal",withCloseButton:!0,loading:!1,message:"Connection to the Nimplant API server was restored",title:"Connection restored"})}},2456:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return C}});var r=t(5893),o=t(9831),i=t(6721),s=t(356),l=t(4410),a=t(8878),c=t(8964),d=t(1876),u=t(3772),m=t(6556),h=t(8207),p=t(7890),f=t(1664),g=t.n(f),x=t(7294),j=t(1776),v=t.n(j),y=function(n){let{np:e,largeScreen:t}=n;return(0,r.jsx)(s.Z,{grow:!0,py:20,pl:t?50:0,className:v().group,children:(0,r.jsx)(g(),{href:"/nimplants/details?guid=".concat(e.guid),passHref:!0,style:{textDecoration:"none"},children:(0,r.jsxs)(s.Z,{style:{color:"var(--mantine-color-gray-7)"},grow:!0,children:[(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(s.Z,{ml:t?-50:0,hidden:!t&&!1,style:n=>e.late?{color:n.colors.orange[3]}:e.active?{color:n.colors.green[3]}:{color:n.colors.rose[3]},children:e.active&&!e.late?(0,r.jsx)(o.gjK,{size:"1.5em"}):(0,r.jsx)(o.J8O,{size:"1.5em"})}),(0,r.jsxs)(h.K,{gap:0,align:"flex-start",children:[(0,r.jsx)(l.x,{fw:"bold",pl:t?10:0,style:{color:"var(--mantine-color-rose-6)"},children:t?"".concat(e.id," - ").concat(e.guid):e.guid}),(0,r.jsxs)(s.Z,{pl:t?10:0,style:{color:"var(--mantine-color-gray-5)"},children:[(0,r.jsx)(s.Z,{hidden:!t,children:(0,r.jsx)(o.qyc,{})}),(0,r.jsx)(l.x,{ml:t?-10:0,children:(0,u.VG)(e.lastCheckin)})]})]})]}),(0,r.jsx)(s.Z,{pl:t?10:0,children:(0,r.jsxs)(h.K,{gap:0,align:"flex-start",children:[(0,r.jsxs)(l.x,{children:[e.username," @ ",e.hostname]}),(0,r.jsxs)(s.Z,{style:{color:"var(--mantine-color-gray-5)"},children:[(0,r.jsx)(s.Z,{hidden:!t,children:(0,r.jsx)(o.WIW,{})}),(0,r.jsxs)(l.x,{ml:t?-10:0,children:[e.pname," (",e.pid,")"]})]})]})}),(0,r.jsxs)(s.Z,{pl:t?15:5,children:[(0,r.jsxs)(h.K,{gap:0,align:"flex-start",children:[(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(s.Z,{hidden:!t,children:(0,r.jsx)(o.AEx,{})}),(0,r.jsx)(l.x,{ml:t?-10:0,children:e.ipAddrInt})]}),(0,r.jsxs)(s.Z,{style:{color:"var(--mantine-color-gray-5)"},children:[(0,r.jsx)(s.Z,{hidden:!t,children:(0,r.jsx)(o.H_w,{})}),(0,r.jsx)(l.x,{ml:t?-10:0,children:e.ipAddrExt})]})]}),(0,r.jsxs)(s.Z,{hidden:!t,m:0,p:0,style:{color:"var(--mantine-color-gray-5)",position:"absolute",float:"right",right:"50px"},children:[(0,r.jsx)(p.T,{}),(0,r.jsx)(o.H_v,{size:"1.5em"})]})]})]})})})},w=function(){let n=(0,c.a)("(min-width: 800px)"),{nimplants:e,nimplantsLoading:t,nimplantsError:i}=(0,u.S4)();return((0,x.useEffect)(()=>{i?(0,u.or)():e&&(0,u.Xe)()}),t||i)?(0,r.jsxs)(s.Z,{py:"xl",style:{color:"var(--mantine-color-gray-5)"},children:[(0,r.jsx)(m.a,{variant:"dots"}),(0,r.jsx)(l.x,{size:"md",children:"Loading..."})]}):0===e.length?(0,r.jsxs)(s.Z,{py:"xl",style:{color:"var(--mantine-color-gray-5)"},children:[(0,r.jsx)(o.UMU,{size:"1.5em"}),(0,r.jsx)(l.x,{size:"md",children:"Nothing here..."})]}):e.map(e=>(0,r.jsx)(y,{np:e,largeScreen:n||!1},e.guid))},C=()=>{let n=(0,c.a)("(min-width: 800px)");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{title:"Nimplants",icon:(0,r.jsx)(o.bHw,{size:"2em"})}),(0,r.jsxs)(i.x,{ml:n?"sm":0,mr:n?"lg":"sm",mt:"xl",children:[(0,r.jsxs)(s.Z,{pl:n?75:10,mb:"lg",grow:!0,style:{color:"var(--mantine-color-gray-5)"},children:[(0,r.jsx)(l.x,{size:"lg",children:"Nimplant"}),(0,r.jsx)(l.x,{size:"lg",children:"System"}),(0,r.jsx)(l.x,{size:"lg",children:"Network"})]}),(0,r.jsx)(a.Z,{withBorder:!0,radius:"md",py:0,px:n?"xl":"sm",children:(0,r.jsx)(w,{})})]})]})}},1776:function(n){n.exports={group:"liststyles_group__QuRpK"}},8878:function(n,e,t){"use strict";t.d(e,{Z:function(){return v}});var r=t(5893),o=t(7294),i=t(9429),s=t(3637),l=t(987),a=t(6976),c=t(3362),d=t(4124);let[u,m]=(0,t(6197).R)("Card component was not found in tree");var h=t(8855),p={root:"m_e615b15f",section:"m_599a2148"};let f={},g=(0,c.b)((n,e)=>{let{classNames:t,className:o,style:i,styles:s,vars:a,withBorder:c,inheritPadding:d,mod:u,...p}=(0,l.w)("CardSection",f,n),g=m();return(0,r.jsx)(h.x,{ref:e,mod:[{"with-border":c,"inherit-padding":d},u],...g.getStyles("section",{className:o,style:i,styles:s,classNames:t}),...p})});g.classes=p,g.displayName="@mantine/core/CardSection";let x={},j=(0,s.Z)((n,{padding:e})=>({root:{"--card-padding":(0,i.bG)(e)}})),v=(0,c.b)((n,e)=>{let t=(0,l.w)("Card",x,n),{classNames:i,className:s,style:c,styles:m,unstyled:h,vars:f,children:v,padding:y,...w}=t,C=(0,a.y)({name:"Card",props:t,classes:p,className:s,style:c,classNames:i,styles:m,unstyled:h,vars:f,varsResolver:j}),Z=o.Children.toArray(v),E=Z.map((n,e)=>"object"==typeof n&&n&&"type"in n&&n.type===g?(0,o.cloneElement)(n,{"data-first-section":0===e||void 0,"data-last-section":e===Z.length-1||void 0}):n);return(0,r.jsx)(u,{value:{getStyles:C},children:(0,r.jsx)(d.X,{ref:e,unstyled:h,...C("root"),...w,children:E})})});v.classes=p,v.displayName="@mantine/core/Card",v.Section=g}},function(n){n.O(0,[188,7,888,774,179],function(){return n(n.s=5801)}),_N_E=n.O()}]);