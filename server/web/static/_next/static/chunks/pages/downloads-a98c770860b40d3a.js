(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[526],{6771:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/downloads",function(){return t(9861)}])},1876:function(n,e,t){"use strict";var o=t(5893),r=t(4124),i=t(356),l=t(8008);t(7294),e.Z=function(n){let{title:e,icon:t,noBorder:s=!1}=n;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(r.X,{p:"xl",pl:50,m:-25,mb:s?0:"md",withBorder:!s,style:{height:"100px",backgroundColor:"var(--mantine-color-gray-0)"},children:(0,o.jsxs)(i.Z,{children:[t," ",(0,o.jsx)(l.D,{order:1,children:e})]})})})}},3772:function(n,e,t){"use strict";t.d(e,{Ex:function(){return P},IZ:function(){return u},L6:function(){return p},QL:function(){return y},S4:function(){return f},TW:function(){return g},VG:function(){return C},XP:function(){return v},Xe:function(){return b},ZS:function(){return T},a6:function(){return w},cT:function(){return j},i$:function(){return N},or:function(){return Z},r5:function(){return h},td:function(){return E},uV:function(){return x},yb:function(){return m}});var o,r=t(4998),i=t(8954),l=t(7886),s=t(1686),a=t(1758),o=window.location.origin;let c={commands:"".concat(o,"/api/commands"),downloads:"".concat(o,"/api/downloads"),server:"".concat(o,"/api/server"),serverExit:"".concat(o,"/api/server/exit"),serverConsole:function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(o,"/api/server/console/").concat(n,"/").concat(e)},upload:"".concat(o,"/api/upload"),nimplants:"".concat(o,"/api/nimplants"),nimplantInfo:n=>"".concat(o,"/api/nimplants/").concat(n),nimplantExit:n=>"".concat(o,"/api/nimplants/").concat(n,"/exit"),nimplantCommand:n=>"".concat(o,"/api/nimplants/").concat(n,"/command"),nimplantConsole:function(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(o,"/api/nimplants/").concat(n,"/console/").concat(e,"/").concat(t)}},d=n=>fetch(n).then(n=>n.json());function u(){let{data:n,error:e}=(0,a.ZP)(c.commands,d);return{commandList:n,commandListLoading:!e&&!n,commandListError:e}}function m(){let{data:n,error:e}=(0,a.ZP)(c.downloads,d,{refreshInterval:5e3});return{downloads:n,downloadsLoading:!e&&!n,downloadsError:e}}function p(){let{data:n,error:e}=(0,a.ZP)(c.server,d);return{serverInfo:n,serverInfoLoading:!e&&!n,serverInfoError:e}}function h(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3,{data:e,error:t}=(0,a.ZP)(c.serverConsole(n),d,{refreshInterval:5e3});return{serverConsole:e,serverConsoleLoading:!t&&!e,serverConsoleError:t}}function f(){let{data:n,error:e}=(0,a.ZP)(c.nimplants,d,{refreshInterval:2500});return{nimplants:n,nimplantsLoading:!e&&!n,nimplantsError:e}}function g(n){let{data:e,error:t}=(0,a.ZP)(c.nimplantInfo(n),d,{refreshInterval:5e3});return{nimplantInfo:e,nimplantInfoLoading:!t&&!e,nimplantInfoError:t}}function x(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,{data:t,error:o}=(0,a.ZP)(c.nimplantConsole(n,e),d,{refreshInterval:1e3});return{nimplantConsole:t,nimplantConsoleLoading:!o&&!t,nimplantConsoleError:o}}function v(){fetch(c.serverExit,{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{r.N9.show({title:"OK",message:"Server is shutting down",color:"green"})}).catch(()=>{r.N9.show({title:"Error",message:"Error shutting down server",color:"red"})})}function w(n){fetch(c.nimplantExit(n),{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{r.N9.show({title:"OK",message:"Killing Nimplant",color:"green"})}).catch(()=>{r.N9.show({title:"Error",message:"Error killing Nimplant",color:"red"})})}function y(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};fetch(c.nimplantCommand(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e})}).then(n=>{n.ok?(r.N9.show({title:"OK",message:"Command '"+e.split(" ")[0]+"' submitted",color:"green"}),t()):r.N9.show({title:"Error",message:"Error sending command",color:"red"})})}function j(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};if(n.size>5242880&&!confirm("The selected file is larger than 5MB, which may cause unpredictable behavior.\nAre you sure you want to continue?")){t();return}let o=new FormData;o.append("file",n),o.append("filename",n.name),fetch(c.upload,{method:"POST",body:o}).then(n=>{n.json().then(t=>{n.ok?(r.N9.show({title:"OK",message:"File uploaded to server",color:"green"}),e(t.path)):r.N9.show({title:"Error",message:"Error uploading file",color:"red"})})})}function C(n){let e=(0,i.Qc)(n,"dd/MM/yyyy HH:mm:ss",new Date);return(0,l.Q)(e,{includeSeconds:!0,addSuffix:!0})}function E(n){if(0===n)return"0 B";let e=Math.floor(Math.log(n)/Math.log(1024));return parseFloat((n/Math.pow(1024,e)).toFixed(1))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][e]}function N(n){return(0,s.WU)(new Date(1e3*n),"yyyy/MM/dd HH:mm:ss")}function T(n){let e=n.config.listenerHost?n.config.listenerHost:n.config.listenerIp;var t=":".concat(n.config.listenerPort);return("HTTP"===n.config.listenerType&&80===n.config.listenerPort||"HTTPS"===n.config.listenerType&&443===n.config.listenerPort)&&(t=""),"".concat(n.config.listenerType.toLowerCase(),"://").concat(e).concat(t)}function P(n){for(var e="",t=0;t<n.length;t++)n[t].task&&(e+="[".concat(n[t].taskTime,"] > ").concat(n[t].taskFriendly,"\n")),e+="[".concat(n[t].resultTime,"]   ").concat(n[t].result,"\n");return e}function Z(){r.N9.show({id:"ConnErr",autoClose:!1,color:"red",withCloseButton:!1,loading:!0,message:"Trying to reconnect to Nimplant API server",title:"Connection error"})}function b(){r.N9.update({id:"ConnErr",autoClose:3e3,color:"teal",withCloseButton:!0,loading:!1,message:"Connection to the Nimplant API server was restored",title:"Connection restored"})}},9861:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return v}});var o=t(5893),r=t(9831),i=t(6721),l=t(356),s=t(4410),a=t(8878),c=t(8964),d=t(3772),u=t(8207),m=t(1664),p=t.n(m),h=t(1776),f=t.n(h),g=function(){let{downloads:n,downloadsLoading:e,downloadsError:t}=(0,d.yb)(),{nimplants:i,nimplantsLoading:a,nimplantsError:c}=(0,d.S4)();return n&&0!==n.length?(0,o.jsx)(o.Fragment,{children:n.map((n,e)=>{var t,r;return(0,o.jsx)(l.Z,{py:"md",grow:!0,className:f().group,children:(0,o.jsx)(p(),{href:"/api/downloads/".concat(n.nimplant,"/").concat(n.name),passHref:!0,style:{textDecoration:"none"},children:(0,o.jsxs)(l.Z,{grow:!0,children:[(0,o.jsx)(s.x,{size:"lg",c:"dark",children:n.name}),(0,o.jsxs)(u.K,{pl:5,gap:0,children:[(0,o.jsx)(s.x,{size:"lg",c:"dark",children:n.nimplant}),(0,o.jsx)(s.x,{size:"md",c:"gray",children:i&&(null===(t=i.find(e=>e.guid===n.nimplant))||void 0===t?void 0:t.username)+"@"+(null===(r=i.find(e=>e.guid===n.nimplant))||void 0===r?void 0:r.hostname)})]}),(0,o.jsx)(s.x,{pl:10,size:"lg",color:"gray",children:(0,d.td)(n.size)}),(0,o.jsx)(s.x,{pl:20,size:"lg",color:"gray",children:(0,d.i$)(n.lastmodified)})]})})},e)})}):(0,o.jsxs)(l.Z,{py:"xl",style:{color:"var(--mantine-color-gray-5)"},children:[(0,o.jsx)(r.UMU,{size:"1.5em"}),(0,o.jsx)(s.x,{size:"md",children:"Nothing here..."})]})},x=t(1876),v=()=>{let n=(0,c.a)("(min-width: 800px)");return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(x.Z,{title:"Downloads",icon:(0,o.jsx)(r.aBF,{size:"2em"}),noBorder:!0}),(0,o.jsxs)(i.x,{ml:n?"sm":0,mr:n?"lg":"sm",mt:"xl",children:[(0,o.jsxs)(l.Z,{pl:n?25:10,mb:"lg",grow:!0,style:{color:"var(--mantine-color-gray-5)"},children:[(0,o.jsx)(s.x,{size:"lg",children:"Filename"}),(0,o.jsx)(s.x,{size:"lg",children:"Nimplant"}),(0,o.jsx)(s.x,{size:"lg",children:"Size"}),(0,o.jsx)(s.x,{size:"lg",children:"Downloaded"})]}),(0,o.jsx)(a.Z,{withBorder:!0,radius:"md",my:"sm",py:0,px:n?"xl":"sm",children:(0,o.jsx)(g,{})})]})]})}},1776:function(n){n.exports={group:"liststyles_group__QuRpK"}},8878:function(n,e,t){"use strict";t.d(e,{Z:function(){return w}});var o=t(5893),r=t(7294),i=t(9429),l=t(3637),s=t(987),a=t(6976),c=t(3362),d=t(4124);let[u,m]=(0,t(6197).R)("Card component was not found in tree");var p=t(8855),h={root:"m_e615b15f",section:"m_599a2148"};let f={},g=(0,c.b)((n,e)=>{let{classNames:t,className:r,style:i,styles:l,vars:a,withBorder:c,inheritPadding:d,mod:u,...h}=(0,s.w)("CardSection",f,n),g=m();return(0,o.jsx)(p.x,{ref:e,mod:[{"with-border":c,"inherit-padding":d},u],...g.getStyles("section",{className:r,style:i,styles:l,classNames:t}),...h})});g.classes=h,g.displayName="@mantine/core/CardSection";let x={},v=(0,l.Z)((n,{padding:e})=>({root:{"--card-padding":(0,i.bG)(e)}})),w=(0,c.b)((n,e)=>{let t=(0,s.w)("Card",x,n),{classNames:i,className:l,style:c,styles:m,unstyled:p,vars:f,children:w,padding:y,...j}=t,C=(0,a.y)({name:"Card",props:t,classes:h,className:l,style:c,classNames:i,styles:m,unstyled:p,vars:f,varsResolver:v}),E=r.Children.toArray(w),N=E.map((n,e)=>"object"==typeof n&&n&&"type"in n&&n.type===g?(0,r.cloneElement)(n,{"data-first-section":0===e||void 0,"data-last-section":e===E.length-1||void 0}):n);return(0,o.jsx)(u,{value:{getStyles:C},children:(0,o.jsx)(d.X,{ref:e,unstyled:p,...C("root"),...j,children:N})})});w.classes=h,w.displayName="@mantine/core/Card",w.Section=g}},function(n){n.O(0,[188,7,888,774,179],function(){return n(n.s=6771)}),_N_E=n.O()}]);