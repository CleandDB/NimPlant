"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[359],{5216:function(e,n,t){t.d(n,{Z:function(){return components_Console}});var o=t(5893),l=t(7564),r=t(1232),a=t(3723),i=t(535),c=t(3997),s=t(2046),d=t(5154),u=t(4065),h=t(5909),m=t(4707),p=t(3485),x=t(5117),g=t(8818),f=t(9814),C=t(8054),j=t(4151),v=t(9876),y=t(8602),S=t(7294),Cmd_Execute_Assembly=function(e){let{modalOpen:n,setModalOpen:t,npGuid:l}=e,[r,a]=(0,S.useState)(null),[i,u]=(0,S.useState)(""),[h,m]=(0,S.useState)(!0),[b,E]=(0,S.useState)(!0),[T,w]=(0,S.useState)(!1),callbackCommand=e=>{(0,s.QL)(String(l),"execute-assembly BYPASSAMSI=".concat(h?1:0," BLOCKETW=").concat(b?1:0,' "').concat(e,'" ').concat(i),callbackClose)},callbackClose=()=>{t(!1),a(null),u(""),m(!0),E(!0),w(!1)};return(0,o.jsxs)(p.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Execute-Assembly: Execute .NET program"}),size:"auto",centered:!0,children:[(0,o.jsx)(x.x,{children:"Execute a .NET (C#) program in-memory."}),(0,o.jsx)(x.x,{children:"Caution: Running execute-assembly will load the CLR!"}),(0,o.jsx)(g.T,{h:"xl"}),(0,o.jsxs)(f.M,{cols:1,children:[(0,o.jsx)(C.S,{onChange:a,children:e=>(0,o.jsx)(c.z,{color:"gray",...e,children:r?"File: "+r.name:"Select .NET binary"})}),(0,o.jsx)(j.I,{placeholder:"Arguments",value:i,onChange:e=>u(e.currentTarget.value)}),(0,o.jsxs)(v.k,{gap:"xl",justify:"center",align:"center",children:[(0,o.jsx)(y.A,{checked:h,onChange:m,children:"Patch AMSI"}),(0,o.jsx)(y.A,{checked:b,onChange:E,children:"Block ETW"})]})]}),(0,o.jsx)(g.T,{h:"xl"}),(0,o.jsx)(c.z,{onClick:()=>{r&&null!==r&&(w(!0),(0,s.cT)(r,callbackCommand,callbackClose))},leftIcon:(0,o.jsx)(d.fF,{}),sx:{width:"100%"},loading:T,children:"Execute"})]})},b=t(50),E=t(292),T=t(4201),Cmd_Inline_Execute=function(e){let{modalOpen:n,setModalOpen:t,npGuid:a}=e,[i,u]=(0,S.useState)(null),[h,m]=(0,S.useState)("go"),[f,v]=(0,S.useState)([]),[y,w]=(0,S.useState)(!1),updateArgument=(e,n,t)=>{v(f.map((o,l)=>l===e?{value:n,type:t}:o))},removeArgument=e=>{v(f.filter((n,t)=>t!==e))},callbackCommand=e=>{let n=f.map(e=>'"'.concat(e.value,'" ').concat(e.type)).join(" ");(0,s.QL)(String(a),'inline-execute "'.concat(e,'" "').concat(h,'" ').concat(n),callbackClose)},callbackClose=()=>{t(!1),u(null),m("go"),v([]),w(!1)};return(0,o.jsxs)(p.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Inline-Execute: Execute BOF file"}),size:"auto",centered:!0,children:[(0,o.jsx)(x.x,{children:"Execute a Beacon Object File (BOF) in-memory."}),(0,o.jsx)(x.x,{children:"Caution: BOF crashes will crash NimPlant too!"}),(0,o.jsx)(g.T,{h:"xl"}),(0,o.jsxs)(b.r,{columns:4,children:[(0,o.jsx)(b.r.Col,{span:3,children:(0,o.jsx)(r.Z,{grow:!0,children:(0,o.jsx)(C.S,{onChange:u,children:e=>(0,o.jsx)(c.z,{color:"gray",...e,children:i?"BOF file: "+i.name:"Select x64 BOF file"})})})}),(0,o.jsx)(b.r.Col,{span:1,children:(0,o.jsx)(j.I,{placeholder:"Entrypoint",value:h,onChange:e=>m(e.currentTarget.value)})})]}),(0,o.jsx)(l.K,{py:f.length>0?"lg":"sm",children:f.map((e,n)=>(0,o.jsxs)(b.r,{columns:12,children:[(0,o.jsx)(b.r.Col,{span:8,children:(0,o.jsx)(j.I,{placeholder:"Argument ".concat(n+1),value:e.value,onChange:t=>updateArgument(n,t.currentTarget.value,e.type)})}),(0,o.jsx)(b.r.Col,{span:3,children:(0,o.jsx)(E.p,{placeholder:"Argument type",value:e.type,onChange:t=>updateArgument(n,e.value,t.currentTarget.value),data:[{label:"String",value:"z"},{label:"Wide String",value:"Z"},{label:"Integer",value:"i"},{label:"Short",value:"s"},{label:"Binary (b64)",value:"b"}]})}),(0,o.jsx)(b.r.Col,{span:1,children:(0,o.jsx)(T.P,{size:"lg",onClick:()=>removeArgument(n)})})]},n))}),(0,o.jsx)(r.Z,{grow:!0,children:(0,o.jsx)(c.z,{color:"gray",onClick:()=>{v([...f,{value:"",type:"z"}])},children:"Add argument"})}),(0,o.jsx)(g.T,{h:"xl"}),(0,o.jsx)(c.z,{onClick:()=>{i&&null!==i&&(w(!0),(0,s.cT)(i,callbackCommand,callbackClose))},leftIcon:(0,o.jsx)(d.fF,{}),loading:y,sx:{width:"100%"},children:"Execute"})]})},w=t(4882),Cmd_Shinject=function(e){let{modalOpen:n,setModalOpen:t,npGuid:l}=e,[r,a]=(0,S.useState)(null),[i,u]=(0,S.useState)(void 0),[h,m]=(0,S.useState)(!1),callbackCommand=e=>{(0,s.QL)(String(l),"shinject ".concat(i,' "').concat(e,'"'),callbackClose)},callbackClose=()=>{t(!1),a(null),u(void 0),m(!1)};return(0,o.jsxs)(p.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Shinject: Inject and execute shellcode"}),size:"auto",centered:!0,children:[(0,o.jsx)(x.x,{children:"Execute shellcode in a selected target process using dynamic invocation."}),(0,o.jsx)(g.T,{h:"xl"}),(0,o.jsxs)(f.M,{cols:1,children:[(0,o.jsx)(C.S,{onChange:a,children:e=>(0,o.jsx)(c.z,{color:"gray",...e,children:r?"File: "+r.name:"Select shellcode file"})}),(0,o.jsx)(w.Y,{placeholder:"Target Process (PID)",value:i,icon:(0,o.jsx)(d.ULU,{}),onChange:e=>u(e),min:0,precision:0})]}),(0,o.jsx)(g.T,{h:"xl"}),(0,o.jsx)(c.z,{onClick:()=>{r&&null!==r&&(m(!0),(0,s.cT)(r,callbackCommand,callbackClose))},leftIcon:(0,o.jsx)(d.fF,{}),sx:{width:"100%"},loading:h,children:"Execute"})]})},Cmd_Upload=function(e){let{modalOpen:n,setModalOpen:t,npGuid:l}=e,[r,a]=(0,S.useState)(null),[i,u]=(0,S.useState)(""),[h,m]=(0,S.useState)(!1),callbackCommand=e=>{(0,s.QL)(String(l),'upload "'.concat(e,'" "').concat(i,'"'),callbackClose)},callbackClose=()=>{t(!1),a(null),u(""),m(!1)};return(0,o.jsxs)(p.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Upload: Upload a file"}),size:"auto",centered:!0,children:[(0,o.jsx)(x.x,{children:"Upload a file to the target."}),(0,o.jsx)(g.T,{h:"xl"}),(0,o.jsxs)(f.M,{cols:1,children:[(0,o.jsx)(C.S,{onChange:a,children:e=>(0,o.jsx)(c.z,{color:"gray",...e,children:r?"File: "+r.name:"Select file"})}),(0,o.jsx)(j.I,{placeholder:"Destination Path (optional)",value:i,onChange:e=>u(e.currentTarget.value)})]}),(0,o.jsx)(g.T,{h:"xl"}),(0,o.jsx)(c.z,{onClick:()=>{r&&null!==r&&(m(!0),(0,s.cT)(r,callbackCommand,callbackClose))},leftIcon:(0,o.jsx)(d.DUB,{}),sx:{width:"100%"},loading:h,children:"Upload"})]})},components_Console=function(e){let{allowInput:n,consoleData:t,disabled:p,guid:x,inputFunction:g}=e,f=(0,u.a)("(min-width: 800px)"),C=(0,S.useRef)(),[j,v]=(0,S.useState)(!0),y=(0,h.P)(),[b,E]=(0,S.useState)([]),[T,w]=(0,S.useState)(!1),[k,I]=(0,S.useState)(""),[F,P]=(0,S.useState)(0),[B,O]=(0,S.useState)(!1),[Z,L]=(0,S.useState)(!1),[A,z]=(0,S.useState)(!1),[M,N]=(0,S.useState)(!1),{commandList:_,commandListLoading:H,commandListError:D}=(0,s.IZ)(),handleSubmit=()=>{if(void 0!==g&&void 0!==x){if(0===b.length)w(!1);else if(T)return;"execute-assembly"===k?O(!0):"inline-execute"===k?L(!0):"shinject"===k?z(!0):"upload"===k?N(!0):g(x,k),P(0),I("")}},handleHistory=e=>{let n=t.filter(e=>null!==e.taskFriendly),o=n.length;var l=F+e;if(0!==o&&(n.some(e=>e.taskFriendly==k)||""===k)&&(0!==F||1!==e)){if(0===F&&-1===e&&(l=o),l<1)l=1;else if(l>o){P(0),I("");return}P(l),I(n[l-1].taskFriendly)}},scrollToBottom=()=>{var e,n;null===(n=C.current)||void 0===n||n.scrollTo({top:null===(e=C.current)||void 0===e?void 0:e.scrollHeight,behavior:"smooth"})};return(0,S.useEffect)(()=>{j&&scrollToBottom()}),(0,S.useEffect)(()=>{E((()=>{if(""===k)return[];var e=[];return H||D||(e=_.map(e=>e.command)),Object.keys(t).forEach(n=>{if(null!==t[n].taskFriendly){var o=t[n].taskFriendly;e.includes(o)||e.push(o)}}),e.filter(e=>e.startsWith(k)&&e!=k)})())},[k,H,D,t,_]),(0,o.jsxs)(l.K,{ml:f?"xl":"lg",mr:f?40:35,mt:"xl",spacing:"xs",sx:()=>({height:"calc(100vh - 275px)",display:"flex"}),children:[(0,o.jsx)(Cmd_Execute_Assembly,{modalOpen:B,setModalOpen:O,npGuid:x}),(0,o.jsx)(Cmd_Inline_Execute,{modalOpen:Z,setModalOpen:L,npGuid:x}),(0,o.jsx)(Cmd_Shinject,{modalOpen:A,setModalOpen:z,npGuid:x}),(0,o.jsx)(Cmd_Upload,{modalOpen:M,setModalOpen:N,npGuid:x}),(0,o.jsx)(r.Z,{m:0,p:0,grow:!0,sx:e=>({fontSize:"14px",width:"100%",flex:"1",border:"1px solid",borderColor:e.colors.gray[4],borderRadius:"4px",minHeight:0}),children:(0,o.jsx)(a.x,{viewportRef:C,onScrollPositionChange:e=>{var n,t,o;(null===(n=C.current)||void 0===n?void 0:n.clientHeight)!==void 0&&(e.y+(null===(t=C.current)||void 0===t?void 0:t.clientHeight)===(null===(o=C.current)||void 0===o?void 0:o.scrollHeight)?v(!0):v(!1))},sx:e=>({fontSize:f?"14px":"12px",padding:f?"14px":"6px",whiteSpace:"pre-wrap",fontFamily:"monospace",color:e.colors.gray[8],backgroundColor:e.colors.gray[0],height:"100%"}),children:t?(0,s.Ex)(t):"Loading..."})}),(0,o.jsxs)(r.Z,{hidden:!n,sx:()=>({flex:"0"}),children:[(0,o.jsx)(i.F,{data:b,disabled:p,icon:(0,o.jsx)(d.fF,{size:14}),onChange:I,onDropdownClose:()=>w(!1),onDropdownOpen:()=>w(!0),placeholder:p?"Nimplant is not active":"Type command here...",ref:y,switchDirectionOnFlip:!0,value:k,onKeyDown:(0,m.yr)([["Enter",handleSubmit],["Tab",()=>b.length>0&&I(b[0])],["ArrowUp",()=>handleHistory(-1)],["ArrowDown",()=>handleHistory(1)]]),sx:()=>({flex:"1"})}),(0,o.jsx)(c.z,{disabled:p,onClick:handleSubmit,children:"Run command"})]})]})}},6586:function(e,n,t){var o=t(5893),l=t(2623),r=t(7564),a=t(1232);n.Z=function(e){let{icon:n,content:t}=e;return(0,o.jsx)(l.X,{color:"blue",shadow:"sm",p:"md",withBorder:!0,sx:{height:"100%"},children:(0,o.jsxs)(r.K,{pl:5,align:"flex-start",justify:"space-evenly",spacing:"lg",sx:{height:"100%"},children:[(0,o.jsx)(a.Z,{sx:e=>({color:e.colors.gray[3]}),children:n}),(0,o.jsx)(a.Z,{sx:e=>({color:e.colors.gray[7]}),children:t})]})})}},730:function(e,n,t){var o=t(5893),l=t(2623),r=t(1232),a=t(9236);t(7294),n.Z=function(e){let{title:n,icon:t,noBorder:i=!1}=e;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(l.X,{p:"xl",pl:50,m:-25,mb:i?0:"md",withBorder:!i,sx:e=>({height:"100px",backgroundColor:e.colors.gray[0]}),children:(0,o.jsxs)(r.Z,{children:[t," ",(0,o.jsx)(a.D,{order:1,children:n})]})})})}},2046:function(e,n,t){t.d(n,{Ex:function(){return consoleToText},IZ:function(){return getCommands},L6:function(){return getServerInfo},QL:function(){return submitCommand},S4:function(){return getNimplants},TW:function(){return getNimplantInfo},VG:function(){return timeSince},XP:function(){return serverExit},Xe:function(){return restoreConnectionError},ZS:function(){return getListenerString},a6:function(){return nimplantExit},cT:function(){return uploadFile},i$:function(){return formatTimestamp},or:function(){return showConnectionError},r5:function(){return getServerConsole},td:function(){return formatBytes},uV:function(){return getNimplantConsole},yb:function(){return getDownloads}});var o,l=t(3575),r=t(5592),a=t(9459),i=t(2043),c=t(9734),o=window.location.origin;let s={commands:"".concat(o,"/api/commands"),downloads:"".concat(o,"/api/downloads"),server:"".concat(o,"/api/server"),serverExit:"".concat(o,"/api/server/exit"),serverConsole:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(o,"/api/server/console/").concat(e,"/").concat(n)},upload:"".concat(o,"/api/upload"),nimplants:"".concat(o,"/api/nimplants"),nimplantInfo:e=>"".concat(o,"/api/nimplants/").concat(e),nimplantExit:e=>"".concat(o,"/api/nimplants/").concat(e,"/exit"),nimplantCommand:e=>"".concat(o,"/api/nimplants/").concat(e,"/command"),nimplantConsole:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(o,"/api/nimplants/").concat(e,"/console/").concat(n,"/").concat(t)},nimplantHistory:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return arguments.length>2&&void 0!==arguments[2]&&arguments[2],"".concat(o,"/api/nimplants/").concat(e,"/history/").concat(n)}},fetcher=e=>fetch(e).then(e=>e.json());function getCommands(){let{data:e,error:n}=(0,c.ZP)(s.commands,fetcher);return{commandList:e,commandListLoading:!n&&!e,commandListError:n}}function getDownloads(){let{data:e,error:n}=(0,c.ZP)(s.downloads,fetcher,{refreshInterval:5e3});return{downloads:e,downloadsLoading:!n&&!e,downloadsError:n}}function getServerInfo(){let{data:e,error:n}=(0,c.ZP)(s.server,fetcher);return{serverInfo:e,serverInfoLoading:!n&&!e,serverInfoError:n}}function getServerConsole(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3,{data:n,error:t}=(0,c.ZP)(s.serverConsole(e),fetcher,{refreshInterval:5e3});return{serverConsole:n,serverConsoleLoading:!t&&!n,serverConsoleError:t}}function getNimplants(){let{data:e,error:n}=(0,c.ZP)(s.nimplants,fetcher,{refreshInterval:2500});return{nimplants:e,nimplantsLoading:!n&&!e,nimplantsError:n}}function getNimplantInfo(e){let{data:n,error:t}=(0,c.ZP)(s.nimplantInfo(e),fetcher,{refreshInterval:5e3});return{nimplantInfo:n,nimplantInfoLoading:!t&&!n,nimplantInfoError:t}}function getNimplantConsole(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,{data:t,error:o}=(0,c.ZP)(s.nimplantConsole(e,n),fetcher,{refreshInterval:1e3});return{nimplantConsole:t,nimplantConsoleLoading:!o&&!t,nimplantConsoleError:o}}function serverExit(){fetch(s.serverExit,{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,l.c0)({title:"OK",message:"Server is shutting down",color:"green"})}).catch(()=>{(0,l.c0)({title:"Error",message:"Error shutting down server",color:"red"})})}function nimplantExit(e){fetch(s.nimplantExit(e),{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{(0,l.c0)({title:"OK",message:"Killing Nimplant",color:"green"})}).catch(()=>{(0,l.c0)({title:"Error",message:"Error killing Nimplant",color:"red"})})}function submitCommand(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};fetch(s.nimplantCommand(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:n})}).then(e=>{e.ok?((0,l.c0)({title:"OK",message:"Command '"+n.split(" ")[0]+"' submitted",color:"green"}),t()):(0,l.c0)({title:"Error",message:"Error sending command",color:"red"})})}function uploadFile(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};if(e.size>5242880&&!confirm("The selected file is larger than 5MB, which may cause unpredictable behavior.\nAre you sure you want to continue?")){t();return}let o=new FormData;o.append("file",e),o.append("filename",e.name),fetch(s.upload,{method:"POST",body:o}).then(e=>{e.json().then(t=>{e.ok?((0,l.c0)({title:"OK",message:"File uploaded to server",color:"green"}),n(t.path)):(0,l.c0)({title:"Error",message:"Error uploading file",color:"red"})})})}function timeSince(e){let n=(0,i.Z)(e,"dd/MM/yyyy HH:mm:ss",new Date);return(0,a.Z)(n,{includeSeconds:!0,addSuffix:!0})}function formatBytes(e){if(0===e)return"0 B";let n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(1))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}function formatTimestamp(e){return(0,r.Z)(new Date(1e3*e),"yyyy/MM/dd HH:mm:ss")}function getListenerString(e){let n=e.config.listenerHost?e.config.listenerHost:e.config.listenerIp;var t=":".concat(e.config.listenerPort);return("HTTP"===e.config.listenerType&&80===e.config.listenerPort||"HTTPS"===e.config.listenerType&&443===e.config.listenerPort)&&(t=""),"".concat(e.config.listenerType.toLowerCase(),"://").concat(n).concat(t)}function consoleToText(e){for(var n="",t=0;t<e.length;t++)e[t].task&&(n+="[".concat(e[t].taskTime,"] > ").concat(e[t].taskFriendly,"\n")),n+="[".concat(e[t].resultTime,"]   ").concat(e[t].result,"\n");return n}function showConnectionError(){(0,l.c0)({id:"ConnErr",disallowClose:!0,autoClose:!1,title:"Connection error",message:"Trying to reconnect to Nimplant API server",color:"red",loading:!0})}function restoreConnectionError(){(0,l.wD)({id:"ConnErr",color:"teal",title:"Connection restored",message:"Connection to the Nimplant API server was restored",autoClose:3e3})}}}]);