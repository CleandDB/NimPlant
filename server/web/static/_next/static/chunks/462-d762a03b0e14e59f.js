"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[462],{5102:function(e,n,t){t.d(n,{Z:function(){return F}});var o=t(5893),r=t(8207),l=t(356),i=t(6721),a=t(3886),c=t(4920),s=t(8650),u=t(4066),d=t(8964),h=t(8079),p=t(862),x=t(889),g=t(4410),f=t(7890),m=t(158),v=t(4731),j=t(4014),y=t(5429),C=t(7585),S=t(7294),w=function(e){let{modalOpen:n,setModalOpen:t,npGuid:r}=e,[l,i]=(0,S.useState)(null),[a,d]=(0,S.useState)(""),[h,p]=(0,S.useState)(!0),[w,T]=(0,S.useState)(!0),[E,b]=(0,S.useState)(!1),k=e=>{let n=h?1:0;(0,s.QL)(String(r),"execute-assembly BYPASSAMSI=".concat(n," BLOCKETW=").concat(w?1:0,' "').concat(e,'" ').concat(a),P)},P=()=>{t(!1),i(null),d(""),p(!0),T(!0),b(!1)};return(0,o.jsxs)(x.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Execute-Assembly: Execute .NET program"}),size:"auto",centered:!0,children:[(0,o.jsx)(g.x,{children:"Execute a .NET (C#) program in-memory."}),(0,o.jsx)(g.x,{children:"Caution: Running execute-assembly will load the CLR!"}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsxs)(m.M,{cols:1,children:[(0,o.jsx)(v.S,{onChange:i,children:e=>(0,o.jsx)(c.z,{color:"gray",...e,children:l?"File: "+l.name:"Select .NET binary"})}),(0,o.jsx)(j.I,{placeholder:"Arguments",value:a,onChange:e=>d(e.currentTarget.value)}),(0,o.jsxs)(y.k,{gap:"xl",justify:"center",align:"center",children:[(0,o.jsx)(C.A,{checked:h,onChange:p,variant:"outline",children:"Patch AMSI"}),(0,o.jsx)(C.A,{checked:w,onChange:T,variant:"outline",children:"Block ETW"})]})]}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsx)(c.z,{onClick:()=>{l&&null!==l&&(b(!0),(0,s.cT)(l,k,P))},leftSection:(0,o.jsx)(u.fF,{}),style:{width:"100%"},loading:E,children:"Execute"})]})},T=t(1906),E=t(310),b=t(6141),k=function(e){let{modalOpen:n,setModalOpen:t,npGuid:i}=e,[a,d]=(0,S.useState)(null),[h,p]=(0,S.useState)("go"),[m,y]=(0,S.useState)([]),[C,w]=(0,S.useState)(!1),k=(e,n,t)=>{y(m.map((o,r)=>r===e?{value:n,type:t}:o))},P=e=>{y(m.filter((n,t)=>t!==e))},I=e=>{let n=m.map(e=>'"'.concat(e.value,'" ').concat(e.type)).join(" ");(0,s.QL)(String(i),'inline-execute "'.concat(e,'" "').concat(h,'" ').concat(n),B)},B=()=>{t(!1),d(null),p("go"),y([]),w(!1)};return(0,o.jsxs)(x.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Inline-Execute: Execute BOF file"}),size:"auto",centered:!0,children:[(0,o.jsx)(g.x,{children:"Execute a Beacon Object File (BOF) in-memory."}),(0,o.jsx)(g.x,{children:"Caution: BOF crashes will crash NimPlant too!"}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsxs)(T.r,{columns:4,children:[(0,o.jsx)(T.r.Col,{span:3,children:(0,o.jsx)(l.Z,{grow:!0,children:(0,o.jsx)(v.S,{onChange:d,children:e=>(0,o.jsx)(c.z,{color:"gray",...e,children:a?"BOF file: "+a.name:"Select x64 BOF file"})})})}),(0,o.jsx)(T.r.Col,{span:1,children:(0,o.jsx)(j.I,{placeholder:"Entrypoint",value:h,onChange:e=>p(e.currentTarget.value)})})]}),(0,o.jsx)(r.K,{py:m.length>0?"lg":"sm",children:m.map((e,n)=>(0,o.jsxs)(T.r,{columns:12,children:[(0,o.jsx)(T.r.Col,{span:8,children:(0,o.jsx)(j.I,{placeholder:"Argument ".concat(n+1),value:e.value,onChange:t=>k(n,t.currentTarget.value,e.type)})}),(0,o.jsx)(T.r.Col,{span:3,children:(0,o.jsx)(E.p,{value:e.type,onChange:t=>k(n,e.value,t.currentTarget.value),data:[{label:"String",value:"z"},{label:"Wide String",value:"Z"},{label:"Integer",value:"i"},{label:"Short",value:"s"},{label:"Binary (b64)",value:"b"}]})}),(0,o.jsx)(T.r.Col,{span:1,children:(0,o.jsx)(b.P,{size:"lg",onClick:()=>P(n)})})]},n))}),(0,o.jsx)(l.Z,{grow:!0,children:(0,o.jsx)(c.z,{color:"gray",onClick:()=>{y([...m,{value:"",type:"z"}])},children:"Add argument"})}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsx)(c.z,{onClick:()=>{a&&null!==a&&(w(!0),(0,s.cT)(a,I,B))},leftSection:(0,o.jsx)(u.fF,{}),loading:C,style:{width:"100%"},children:"Execute"})]})},P=t(2578),I=function(e){let{modalOpen:n,setModalOpen:t,npGuid:r}=e,[l,i]=(0,S.useState)(null),[a,d]=(0,S.useState)(void 0),[h,p]=(0,S.useState)(!1),j=e=>{(0,s.QL)(String(r),"shinject ".concat(a,' "').concat(e,'"'),y)},y=()=>{t(!1),i(null),d(void 0),p(!1)};return(0,o.jsxs)(x.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Shinject: Inject and execute shellcode"}),size:"auto",centered:!0,children:[(0,o.jsx)(g.x,{children:"Execute shellcode in a selected target process using dynamic invocation."}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsxs)(m.M,{cols:1,children:[(0,o.jsx)(v.S,{onChange:i,children:e=>(0,o.jsx)(c.z,{color:"gray",...e,children:l?"File: "+l.name:"Select shellcode file"})}),(0,o.jsx)(P.Y,{placeholder:"Target Process (PID)",value:a,leftSection:(0,o.jsx)(u.ULU,{}),onChange:e=>d(Number(e)),min:0})]}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsx)(c.z,{onClick:()=>{l&&null!==l&&(p(!0),(0,s.cT)(l,j,y))},leftSection:(0,o.jsx)(u.fF,{}),style:{width:"100%"},loading:h,children:"Execute"})]})},B=function(e){let{modalOpen:n,setModalOpen:t,npGuid:r}=e,[l,i]=(0,S.useState)(null),[a,d]=(0,S.useState)(""),[h,p]=(0,S.useState)(!1),y=e=>{(0,s.QL)(String(r),'upload "'.concat(e,'" "').concat(a,'"'),C)},C=()=>{t(!1),i(null),d(""),p(!1)};return(0,o.jsxs)(x.u,{opened:n,onClose:()=>t(!1),title:(0,o.jsx)("b",{children:"Upload: Upload a file"}),size:"auto",centered:!0,children:[(0,o.jsx)(g.x,{children:"Upload a file to the target."}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsxs)(m.M,{cols:1,children:[(0,o.jsx)(v.S,{onChange:i,children:e=>(0,o.jsx)(c.z,{color:"gray",...e,children:l?"File: "+l.name:"Select file"})}),(0,o.jsx)(j.I,{placeholder:"Destination Path (optional)",value:a,onChange:e=>d(e.currentTarget.value)})]}),(0,o.jsx)(f.T,{h:"xl"}),(0,o.jsx)(c.z,{onClick:()=>{l&&null!==l&&(p(!0),(0,s.cT)(l,y,C))},leftSection:(0,o.jsx)(u.DUB,{}),style:{width:"100%"},loading:h,children:"Upload"})]})},F=function(e){let{allowInput:n,consoleData:t,disabled:x,guid:g,inputFunction:f}=e,m=(0,d.a)("(min-width: 800px)"),v=(0,S.useRef)(),[j,y]=(0,S.useState)(!0),C=(0,h.P)(),[T,E]=(0,S.useState)([]),[b,P]=(0,S.useState)(!1),[F,O]=(0,S.useState)(""),[N,Z]=(0,S.useState)(0),[z,L]=(0,S.useState)(!1),[M,A]=(0,S.useState)(!1),[H,D]=(0,S.useState)(!1),[K,U]=(0,S.useState)(!1),{commandList:Q,commandListLoading:G,commandListError:R}=(0,s.IZ)(),W=()=>{if(void 0!==f&&void 0!==g){if(0===T.length)P(!1);else if(b)return;"execute-assembly"===F?L(!0):"inline-execute"===F?A(!0):"shinject"===F?D(!0):"upload"===F?U(!0):f(g,F),Z(0),O("")}},X=e=>{let n=t.filter(e=>null!==e.taskFriendly),o=n.length;var r=N+e;if(0!==o&&(n.some(e=>e.taskFriendly==F)||""===F)&&(0!==N||1!==e)){if(0===N&&-1===e&&(r=o),r<1)r=1;else if(r>o){Z(0),O("");return}Z(r),O(n[r-1].taskFriendly)}},_=()=>{var e,n;null===(n=v.current)||void 0===n||n.scrollTo({top:null===(e=v.current)||void 0===e?void 0:e.scrollHeight,behavior:"smooth"})};return(0,S.useEffect)(()=>{j&&_()}),(0,S.useEffect)(()=>{E((()=>{if(""===F)return[];var e=[];return G||R||(e=Q.map(e=>e.command)),Object.keys(t).forEach(n=>{if(null!==t[n].taskFriendly){var o=t[n].taskFriendly;e.includes(o)||e.push(o)}}),e.filter(e=>e.startsWith(F)&&e!=F)})())},[F,G,R,t,Q]),(0,o.jsxs)(r.K,{ml:m?"xl":"lg",mr:m?40:35,mt:"xl",gap:"xs",style:{height:"calc(100vh - 285px)",display:"flex"},children:[(0,o.jsx)(w,{modalOpen:z,setModalOpen:L,npGuid:g}),(0,o.jsx)(k,{modalOpen:M,setModalOpen:A,npGuid:g}),(0,o.jsx)(I,{modalOpen:H,setModalOpen:D,npGuid:g}),(0,o.jsx)(B,{modalOpen:K,setModalOpen:U,npGuid:g}),(0,o.jsx)(l.Z,{m:0,p:0,grow:!0,style:{fontSize:"14px",width:"100%",height:n?"calc(100% - 40px)":"100%",border:"1px solid",borderColor:"var(--mantine-color-gray-4)",borderRadius:"4px"},children:(0,o.jsx)(i.x,{viewportRef:v,onScrollPositionChange:e=>{var n,t,o;(null===(n=v.current)||void 0===n?void 0:n.clientHeight)!==void 0&&(e.y+(null===(t=v.current)||void 0===t?void 0:t.clientHeight)===(null===(o=v.current)||void 0===o?void 0:o.scrollHeight)?y(!0):y(!1))},style:{fontSize:m?"14px":"12px",padding:m?"14px":"6px",whiteSpace:"pre-wrap",fontFamily:"monospace",color:"var(--mantine-color-gray-8)",backgroundColor:"var(--mantine-color-gray-0)",height:"100%",flex:"1"},children:t?(0,s.Ex)(t):"Loading..."})}),n?(0,o.jsxs)(l.Z,{style:{flex:"0"},children:[(0,o.jsx)(a.F,{data:T,disabled:x,leftSection:(0,o.jsx)(u.fF,{size:14}),onChange:O,onDropdownClose:()=>P(!1),onDropdownOpen:()=>P(!0),placeholder:x?"Nimplant is not active":"Type command here...",ref:C,value:F,onKeyDown:(0,p.yr)([["Enter",W],["Tab",()=>T.length>0&&O(T[0])],["ArrowUp",()=>X(-1)],["ArrowDown",()=>X(1)]]),style:{flex:"1"}}),(0,o.jsx)(c.z,{disabled:x,onClick:W,children:"Run command"})]}):null]})}},887:function(e,n,t){var o=t(5893),r=t(4124),l=t(8207),i=t(356);n.Z=function(e){let{icon:n,content:t}=e;return(0,o.jsx)(r.X,{color:"blue",shadow:"sm",p:"md",withBorder:!0,style:{height:"100%"},children:(0,o.jsxs)(l.K,{pl:5,align:"flex-start",justify:"space-evenly",gap:"lg",style:{height:"100%"},children:[(0,o.jsx)(i.Z,{style:{color:"var(--mantine-color-gray-3)"},children:n}),(0,o.jsx)(i.Z,{style:{color:"var(--mantine-color-gray-7)"},children:t})]})})}},6867:function(e,n,t){var o=t(5893),r=t(4124),l=t(356),i=t(8008);t(7294),n.Z=function(e){let{title:n,icon:t,noBorder:a=!1}=e;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(r.X,{p:"xl",pl:50,m:-25,mb:a?0:"md",withBorder:!a,style:{height:"100px",backgroundColor:"var(--mantine-color-gray-0)"},children:(0,o.jsxs)(l.Z,{children:[t," ",(0,o.jsx)(i.D,{order:1,children:n})]})})})}},8650:function(e,n,t){t.d(n,{Ex:function(){return b},IZ:function(){return d},L6:function(){return p},QL:function(){return y},S4:function(){return g},TW:function(){return f},VG:function(){return S},XP:function(){return v},Xe:function(){return P},ZS:function(){return E},a6:function(){return j},cT:function(){return C},i$:function(){return T},or:function(){return k},r5:function(){return x},td:function(){return w},uV:function(){return m},yb:function(){return h}});var o,r=t(4998),l=t(4157),i=t(3899),a=t(2164),c=t(1758),o=window.location.origin;let s={commands:"".concat(o,"/api/commands"),downloads:"".concat(o,"/api/downloads"),server:"".concat(o,"/api/server"),serverExit:"".concat(o,"/api/server/exit"),serverConsole:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(o,"/api/server/console/").concat(e,"/").concat(n)},upload:"".concat(o,"/api/upload"),nimplants:"".concat(o,"/api/nimplants"),nimplantInfo:e=>"".concat(o,"/api/nimplants/").concat(e),nimplantExit:e=>"".concat(o,"/api/nimplants/").concat(e,"/exit"),nimplantCommand:e=>"".concat(o,"/api/nimplants/").concat(e,"/command"),nimplantConsole:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"".concat(o,"/api/nimplants/").concat(e,"/console/").concat(n,"/").concat(t)},nimplantHistory:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return arguments.length>2&&void 0!==arguments[2]&&arguments[2],"".concat(o,"/api/nimplants/").concat(e,"/history/").concat(n)}},u=e=>fetch(e).then(e=>e.json());function d(){let{data:e,error:n}=(0,c.ZP)(s.commands,u);return{commandList:e,commandListLoading:!n&&!e,commandListError:n}}function h(){let{data:e,error:n}=(0,c.ZP)(s.downloads,u,{refreshInterval:5e3});return{downloads:e,downloadsLoading:!n&&!e,downloadsError:n}}function p(){let{data:e,error:n}=(0,c.ZP)(s.server,u);return{serverInfo:e,serverInfoLoading:!n&&!e,serverInfoError:n}}function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3,{data:n,error:t}=(0,c.ZP)(s.serverConsole(e),u,{refreshInterval:5e3});return{serverConsole:n,serverConsoleLoading:!t&&!n,serverConsoleError:t}}function g(){let{data:e,error:n}=(0,c.ZP)(s.nimplants,u,{refreshInterval:2500});return{nimplants:e,nimplantsLoading:!n&&!e,nimplantsError:n}}function f(e){let{data:n,error:t}=(0,c.ZP)(s.nimplantInfo(e),u,{refreshInterval:5e3});return{nimplantInfo:n,nimplantInfoLoading:!t&&!n,nimplantInfoError:t}}function m(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,{data:t,error:o}=(0,c.ZP)(s.nimplantConsole(e,n),u,{refreshInterval:1e3});return{nimplantConsole:t,nimplantConsoleLoading:!o&&!t,nimplantConsoleError:o}}function v(){fetch(s.serverExit,{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{r.N9.show({title:"OK",message:"Server is shutting down",color:"green"})}).catch(()=>{r.N9.show({title:"Error",message:"Error shutting down server",color:"red"})})}function j(e){fetch(s.nimplantExit(e),{method:"POST",headers:{"Content-Type":"application/json"}}).then(()=>{r.N9.show({title:"OK",message:"Killing Nimplant",color:"green"})}).catch(()=>{r.N9.show({title:"Error",message:"Error killing Nimplant",color:"red"})})}function y(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};fetch(s.nimplantCommand(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:n})}).then(e=>{e.ok?(r.N9.show({title:"OK",message:"Command '"+n.split(" ")[0]+"' submitted",color:"green"}),t()):r.N9.show({title:"Error",message:"Error sending command",color:"red"})})}function C(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};if(e.size>5242880&&!confirm("The selected file is larger than 5MB, which may cause unpredictable behavior.\nAre you sure you want to continue?")){t();return}let o=new FormData;o.append("file",e),o.append("filename",e.name),fetch(s.upload,{method:"POST",body:o}).then(e=>{e.json().then(t=>{e.ok?(r.N9.show({title:"OK",message:"File uploaded to server",color:"green"}),n(t.path)):r.N9.show({title:"Error",message:"Error uploading file",color:"red"})})})}function S(e){let n=(0,l.Qc)(e,"dd/MM/yyyy HH:mm:ss",new Date);return(0,i.Q)(n,{includeSeconds:!0,addSuffix:!0})}function w(e){if(0===e)return"0 B";let n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(1))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}function T(e){return(0,a.WU)(new Date(1e3*e),"yyyy/MM/dd HH:mm:ss")}function E(e){let n=e.config.listenerHost?e.config.listenerHost:e.config.listenerIp;var t=":".concat(e.config.listenerPort);return("HTTP"===e.config.listenerType&&80===e.config.listenerPort||"HTTPS"===e.config.listenerType&&443===e.config.listenerPort)&&(t=""),"".concat(e.config.listenerType.toLowerCase(),"://").concat(n).concat(t)}function b(e){for(var n="",t=0;t<e.length;t++)e[t].task&&(n+="[".concat(e[t].taskTime,"] > ").concat(e[t].taskFriendly,"\n")),n+="[".concat(e[t].resultTime,"]   ").concat(e[t].result,"\n");return n}function k(){r.N9.show({id:"ConnErr",autoClose:!1,color:"red",withCloseButton:!1,loading:!0,message:"Trying to reconnect to Nimplant API server",title:"Connection error"})}function P(){r.N9.update({id:"ConnErr",autoClose:3e3,color:"teal",withCloseButton:!0,loading:!1,message:"Connection to the Nimplant API server was restored",title:"Connection restored"})}}}]);